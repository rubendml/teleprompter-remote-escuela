<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Teleprompter Pro</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
  overflow: hidden;
}

#container {
  position: relative;
}

#text {
  font-size: 64px;
  line-height: 1.4;
  padding: 12vh 10vw;
  white-space: pre-wrap;
  transform-origin: center;
}

.mirror {
  transform: scaleX(-1);
}

/* Línea guía */
#guide {
  position: fixed;
  top: 50%;
  left: 0;
  right: 0;
  height: 2px;
  background: rgba(255,255,255,0.25);
  pointer-events: none;
  display: none;
}
</style>
</head>

<body>

<div id="container">
  <div id="text" class="mirror">Esperando texto…</div>
  <div id="guide"></div>
</div>

<script>
const socket = new WebSocket("wss://teleprompter-ws-5ziy.onrender.com");

const textEl = document.getElementById("text");
const guide = document.getElementById("guide");

let scrollSpeed = 0;
let mirror = true;
let showGuide = false;
let y = 0;
let lastTime = null;

function animate(time) {
  if (!lastTime) lastTime = time;
  const delta = time - lastTime;
  lastTime = time;

  y += scrollSpeed * delta * 0.06;
  window.scrollTo(0, y);

  requestAnimationFrame(animate);
}
requestAnimationFrame(animate);

socket.onmessage = (e) => {
  const data = JSON.parse(e.data);

  if (data.action === "text") {
    textEl.innerText = data.value;
    y = 0;
    window.scrollTo(0, 0);
  }

  if (data.action === "speed") scrollSpeed = data.value;
  if (data.action === "mirror") {
    mirror = !mirror;
    textEl.classList.toggle("mirror", mirror);
  }

  if (data.action === "guide") {
    showGuide = !showGuide;
    guide.style.display = showGuide ? "block" : "none";
  }

  if (data.action === "font") {
    textEl.style.fontSize = data.value + "px";
  }
};
</script>

</body>
</html>
