<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Teleprompter Pro</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: black;
  color: #f5f5f5;
  font-family: Arial, Helvetica, sans-serif;
  overflow: hidden;
}

/* Contenedor */
#container {
  position: relative;
}

/* Texto */
#text {
  font-size: 64px;
  line-height: 1.5;
  padding: 14vh 12vw;
  white-space: pre-wrap;
  transform-origin: center;
  transition: all 0.4s ease;
}

/* Espejo */
.mirror {
  transform: scaleX(-1);
}

/* L√≠nea gu√≠a */
#guide {
  position: fixed;
  top: 50%;
  left: 0;
  right: 0;
  height: 2px;
  background: rgba(255,255,255,0.25);
  pointer-events: none;
  display: none;
}

/* Modo c√°mara */
.camera #text {
  color: #f1f1e6;
  padding: 16vh 15vw;
}

.camera #guide {
  display: block;
}
</style>
</head>

<body>

<div id="container">
  <div id="text" class="mirror">Esperando texto‚Ä¶</div>
  <div id="guide"></div>
</div>

<script>
const WS_URL = "wss://teleprompter-ws-5ziy.onrender.com";

const socket = new WebSocket(WS_URL);
const textEl = document.getElementById("text");
const guideEl = document.getElementById("guide");
const body = document.body;

let scrollSpeed = 0;
let yPos = 0;
let mirrorEnabled = true;
let cameraMode = false;
let lastTime = null;

/* WebSocket */
socket.onopen = () => console.log("üü¢ Teleprompter conectado");

socket.onmessage = (e) => {
  const data = JSON.parse(e.data);

  switch (data.action) {
    case "text":
      textEl.innerText = data.value || "";
      yPos = 0;
      window.scrollTo(0, 0);
      break;

    case "speed":
      scrollSpeed = Number(data.value) || 0;
      break;

    case "mirror":
      mirrorEnabled = !mirrorEnabled;
      textEl.classList.toggle("mirror", mirrorEnabled);
      break;

    case "camera":
      cameraMode = !cameraMode;
      body.classList.toggle("camera", cameraMode);
      mirrorEnabled = cameraMode;
      textEl.classList.toggle("mirror", mirrorEnabled);
      break;
  }
};

/* Scroll ultra suave */
function animate(t) {
  if (!lastTime) lastTime = t;
  const delta = t - lastTime;
  lastTime = t;

  yPos += scrollSpeed * delta * 0.06;
  window.scrollTo(0, yPos);

  requestAnimationFrame(animate);
}
requestAnimationFrame(animate);
</script>

</body>
</html>
